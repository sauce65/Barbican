{
  "schema_version": "1.0.0",
  "generated_at": "2025-12-30T21:21:02.425243504Z",
  "barbican_version": "0.1.0",
  "rust_version": "unknown",
  "compliance_profile": "FedRAMP High",
  "artifacts": [
    {
      "control_id": "AC-3",
      "control_name": "Access Enforcement",
      "test_name": "role_and_scope_enforcement",
      "description": "Verify role-based and scope-based access controls work correctly (AC-3)",
      "executed_at": "2025-12-30T21:21:02.425446230Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/auth.rs",
        "line_start": 161,
        "line_end": 184,
        "function": null
      },
      "inputs": {
        "admin_role": "admin",
        "required_scope": "write:data",
        "user_role": "user"
      },
      "expected": {
        "scope_check_works": true,
        "multi_role_check_works": true,
        "role_check_works": true
      },
      "observed": {
        "scope_check_works": true,
        "multi_role_check_works": true,
        "role_check_works": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425376344Z",
          "content": {
            "name": "admin_claims",
            "value": {
              "roles": [
                "user",
                "admin"
              ],
              "scopes": [
                "write:data",
                "read:data"
              ],
              "subject": "user-123"
            }
          },
          "description": null
        },
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425397302Z",
          "content": {
            "name": "user_claims",
            "value": {
              "roles": [
                "user"
              ],
              "scopes": [
                "read:data"
              ],
              "subject": "user-456"
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425421225Z",
          "content": {
            "details": {
              "admin_has_admin": true,
              "user_has_admin": false
            },
            "passed": true
          },
          "description": "Admin should have admin role, user should not"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425424741Z",
          "content": {
            "details": {
              "admin_has_write": true,
              "user_has_write": false
            },
            "passed": true
          },
          "description": "Admin should have write scope, user should not"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425431674Z",
          "content": {
            "details": {
              "has_all_admin_user": true,
              "has_any_admin_superuser": true
            },
            "passed": true
          },
          "description": "Multi-role checks should work correctly"
        }
      ],
      "related_controls": [
        "AC-6",
        "IA-2"
      ]
    },
    {
      "control_id": "AC-4",
      "control_name": "Information Flow Enforcement",
      "test_name": "cors_not_permissive_by_default",
      "description": "Verify CORS is not permissive by default (AC-4)",
      "executed_at": "2025-12-30T21:21:02.425485161Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/config.rs",
        "line_start": 155,
        "line_end": 165,
        "function": null
      },
      "inputs": {},
      "expected": {
        "permissive_detected": true,
        "default_not_permissive": true
      },
      "observed": {
        "permissive_detected": true,
        "default_not_permissive": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425466347Z",
          "content": {
            "details": {
              "cors_origins": [],
              "is_permissive": false
            },
            "passed": true
          },
          "description": "Default CORS should not be permissive"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425470354Z",
          "content": {
            "details": {
              "is_permissive": true
            },
            "passed": true
          },
          "description": "Permissive CORS should be detected"
        }
      ],
      "related_controls": []
    },
    {
      "control_id": "AC-7",
      "control_name": "Unsuccessful Logon Attempts",
      "test_name": "lockout_after_max_attempts",
      "description": "Verify account locks after configured number of failed login attempts (AC-7)",
      "executed_at": "2025-12-30T21:21:02.425540050Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/login.rs",
        "line_start": 418,
        "line_end": 554,
        "function": null
      },
      "inputs": {
        "username": "test@example.com",
        "max_attempts": 3
      },
      "expected": {
        "allowed_before_lockout": true,
        "locked_after_3_attempts": true
      },
      "observed": {
        "locked_after_3_attempts": true,
        "allowed_before_lockout": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425494207Z",
          "content": {
            "name": "lockout_policy",
            "value": {
              "lockout_duration_secs": 1800,
              "max_attempts": 3,
              "progressive_lockout": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425523700Z",
          "content": "Attempt 1: failed_count=1, is_locked=false",
          "description": null
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425525554Z",
          "content": "Attempt 2: failed_count=2, is_locked=false",
          "description": null
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425528188Z",
          "content": "Attempt 3: failed_count=3, is_locked=true",
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425529210Z",
          "content": {
            "details": {
              "attempt1_allowed": true,
              "attempt2_allowed": true
            },
            "passed": true
          },
          "description": "First two attempts should not lock out"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425531504Z",
          "content": {
            "details": {
              "locked_after_3": true
            },
            "passed": true
          },
          "description": "Third attempt should trigger lockout"
        }
      ],
      "related_controls": [
        "AC-2",
        "IA-5"
      ]
    },
    {
      "control_id": "AC-11",
      "control_name": "Session Lock",
      "test_name": "session_timeout_configuration",
      "description": "Verify session policy includes idle and absolute timeout (AC-11)",
      "executed_at": "2025-12-30T21:21:02.425575885Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/session.rs",
        "line_start": 43,
        "line_end": 167,
        "function": null
      },
      "inputs": {
        "expected_max_lifetime": true,
        "expected_idle_timeout": true
      },
      "expected": {
        "idle_timeout_configured": true,
        "max_lifetime_configured": true,
        "fresh_session_valid": true
      },
      "observed": {
        "idle_timeout_configured": true,
        "max_lifetime_configured": true,
        "fresh_session_valid": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425553204Z",
          "content": {
            "name": "session_policy",
            "value": {
              "allow_extension": false,
              "idle_timeout_secs": 900,
              "max_lifetime_secs": 14400,
              "require_reauth_for_sensitive": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425558313Z",
          "content": {
            "details": {
              "idle_timeout_secs": 900
            },
            "passed": true
          },
          "description": "Idle timeout should be configured"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425562300Z",
          "content": {
            "details": {
              "max_lifetime_secs": 14400
            },
            "passed": true
          },
          "description": "Max lifetime should be configured"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425566768Z",
          "content": {
            "details": {
              "termination_reason": "None"
            },
            "passed": true
          },
          "description": "Fresh session should not be terminated"
        }
      ],
      "related_controls": [
        "AC-12",
        "SC-10"
      ]
    },
    {
      "control_id": "AC-12",
      "control_name": "Session Termination",
      "test_name": "absolute_timeout_enforcement",
      "description": "Verify sessions terminate after max lifetime is exceeded (AC-12)",
      "executed_at": "2025-12-30T21:21:02.425605909Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/session.rs",
        "line_start": 143,
        "line_end": 167,
        "function": null
      },
      "inputs": {
        "max_lifetime_hours": 4
      },
      "expected": {
        "max_lifetime_enforced": true,
        "fresh_session_valid": true
      },
      "observed": {
        "fresh_session_valid": true,
        "max_lifetime_enforced": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425587906Z",
          "content": {
            "name": "session_policy",
            "value": {
              "allow_extension": false,
              "idle_timeout_secs": 900,
              "max_lifetime_secs": 14400
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425592425Z",
          "content": {
            "details": {
              "termination_reason": "None"
            },
            "passed": true
          },
          "description": "Fresh session should not be terminated"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425593947Z",
          "content": {
            "details": {
              "max_lifetime_secs": 14400
            },
            "passed": true
          },
          "description": "Max lifetime should be configured"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425599618Z",
          "content": {
            "details": {
              "idle_timeout_msg": "Your session timed out due to inactivity. Please sign in again.",
              "max_lifetime_msg": "Your session has expired. Please sign in again.",
              "token_expired_msg": "Your session has expired. Please sign in again."
            },
            "passed": true
          },
          "description": "Termination reasons should have messages"
        }
      ],
      "related_controls": [
        "AC-11",
        "SC-10"
      ]
    },
    {
      "control_id": "AU-2",
      "control_name": "Audit Events",
      "test_name": "security_event_coverage",
      "description": "Verify all required security event types are defined (AU-2)",
      "executed_at": "2025-12-30T21:21:02.425641944Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/observability/events.rs",
        "line_start": 38,
        "line_end": 120,
        "function": null
      },
      "inputs": {},
      "expected": {
        "has_auth_events": true,
        "has_access_events": true,
        "has_system_events": true
      },
      "observed": {
        "has_system_events": true,
        "has_access_events": true,
        "has_auth_events": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425615536Z",
          "content": "Auth events defined: 5",
          "description": null
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425615917Z",
          "content": "Access events defined: 2",
          "description": null
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425616278Z",
          "content": "System events defined: 3",
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425621187Z",
          "content": {
            "details": {
              "events": [
                "authentication_success",
                "authentication_failure",
                "logout",
                "session_created",
                "session_destroyed"
              ]
            },
            "passed": true
          },
          "description": "Authentication events should be defined"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425625695Z",
          "content": {
            "details": {
              "events": [
                "access_granted",
                "access_denied"
              ]
            },
            "passed": true
          },
          "description": "Access control events should be defined"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425631726Z",
          "content": {
            "details": {
              "events": [
                "system_startup",
                "system_shutdown",
                "configuration_changed"
              ]
            },
            "passed": true
          },
          "description": "System events should be defined"
        }
      ],
      "related_controls": [
        "AU-3",
        "AU-12"
      ]
    },
    {
      "control_id": "AU-3",
      "control_name": "Content of Audit Records",
      "test_name": "audit_record_fields",
      "description": "Verify security events have required audit fields (AU-3)",
      "executed_at": "2025-12-30T21:21:02.425670335Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/observability/events.rs",
        "line_start": 120,
        "line_end": 200,
        "function": null
      },
      "inputs": {},
      "expected": {
        "has_name": true,
        "has_category": true,
        "has_severity": true
      },
      "observed": {
        "has_name": true,
        "has_category": true,
        "has_severity": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425649077Z",
          "content": {
            "details": {
              "name": "authentication_failure"
            },
            "passed": true
          },
          "description": "Event should have a name"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425650900Z",
          "content": {
            "details": {
              "category": "authentication"
            },
            "passed": true
          },
          "description": "Event should have a category"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425653104Z",
          "content": {
            "details": {
              "severity": "High"
            },
            "passed": true
          },
          "description": "Event should have a severity"
        },
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425658544Z",
          "content": {
            "name": "sample_event",
            "value": {
              "category": "authentication",
              "event": "AuthenticationFailure",
              "name": "authentication_failure",
              "severity": "High"
            }
          },
          "description": null
        }
      ],
      "related_controls": [
        "AU-2"
      ]
    },
    {
      "control_id": "AU-8",
      "control_name": "Time Stamps",
      "test_name": "security_event_timestamps",
      "description": "Verify all security events have UTC timestamps (AU-8)",
      "executed_at": "2025-12-30T21:21:02.425707332Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/observability/events.rs",
        "line_start": 38,
        "line_end": 293,
        "function": null
      },
      "inputs": {},
      "expected": {
        "events_have_timestamp_field": true,
        "tracing_provides_utc": true
      },
      "observed": {
        "tracing_provides_utc": true,
        "events_have_timestamp_field": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425680834Z",
          "content": {
            "name": "timestamp_source",
            "value": {
              "automatic": true,
              "format": "RFC 3339 / ISO 8601",
              "provider": "tracing crate",
              "timezone": "UTC"
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425694830Z",
          "content": {
            "details": {
              "event_count": 6,
              "event_types": [
                "AuthenticationSuccess",
                "AuthenticationFailure",
                "AccessDenied",
                "SessionCreated",
                "SessionDestroyed",
                "RateLimitExceeded"
              ]
            },
            "passed": true
          },
          "description": "Security events should exist for timestamping"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425698386Z",
          "content": {
            "details": {
              "json_format": true,
              "tracing_subscriber_version": "0.3",
              "utc_default": true
            },
            "passed": true
          },
          "description": "Tracing should provide UTC timestamps"
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.425702964Z",
          "content": "AU-8: Timestamps are automatically added by tracing crate in UTC",
          "description": null
        }
      ],
      "related_controls": [
        "AU-2",
        "AU-3",
        "AU-12"
      ]
    },
    {
      "control_id": "AU-9",
      "control_name": "Protection of Audit Information",
      "test_name": "audit_log_integrity",
      "description": "Verify audit logs are signed and tamper-evident (AU-9)",
      "executed_at": "2025-12-30T21:21:02.426018094Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/audit/integrity.rs",
        "line_start": 1,
        "line_end": 150,
        "function": null
      },
      "inputs": {},
      "expected": {
        "tamper_detection_works": true,
        "records_are_signed": true,
        "algorithm_is_approved": true,
        "chain_is_intact": true
      },
      "observed": {
        "records_are_signed": true,
        "tamper_detection_works": true,
        "algorithm_is_approved": true,
        "chain_is_intact": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.425718022Z",
          "content": {
            "name": "integrity_config",
            "value": {
              "algorithm": "HMAC-SHA256",
              "chain_records": true,
              "key_length_bytes": 32
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425725084Z",
          "content": {
            "details": {
              "algorithm": "HMAC-SHA256",
              "nist_approved": true
            },
            "passed": true
          },
          "description": "Algorithm should be NIST-approved HMAC-SHA256"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425828281Z",
          "content": {
            "details": {
              "record1_signed": true,
              "record2_signed": true,
              "signature_length": 64
            },
            "passed": true
          },
          "description": "All audit records should be HMAC signed"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425917142Z",
          "content": {
            "details": {
              "chain_intact": true,
              "errors": [],
              "records_verified": 2
            },
            "passed": true
          },
          "description": "Audit chain integrity should be verifiable"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.425934914Z",
          "content": {
            "details": {
              "hash_matches_previous": true,
              "record2_has_previous_hash": true
            },
            "passed": true
          },
          "description": "Records should be cryptographically chained"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426005892Z",
          "content": {
            "details": {
              "error_count": 1,
              "tamper_detected": true,
              "verification_failed": true
            },
            "passed": true
          },
          "description": "Tampered records should be detected"
        }
      ],
      "related_controls": [
        "AU-3",
        "AU-12"
      ]
    },
    {
      "control_id": "AU-12",
      "control_name": "Audit Record Generation",
      "test_name": "audit_record_creation",
      "description": "Verify audit records can be generated with required fields (AU-12)",
      "executed_at": "2025-12-30T21:21:02.426064558Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/audit.rs",
        "line_start": 266,
        "line_end": 313,
        "function": null
      },
      "inputs": {},
      "expected": {
        "record_has_required_fields": true,
        "outcomes_defined": true
      },
      "observed": {
        "record_has_required_fields": true,
        "outcomes_defined": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426037700Z",
          "content": {
            "name": "audit_record",
            "value": {
              "action": "POST",
              "actor": "user-123",
              "details": "Login successful",
              "event_type": "authentication",
              "id": "audit-001",
              "outcome": "success",
              "resource": "/api/login",
              "source_ip": "192.168.1.100",
              "timestamp": "2025-12-18T12:00:00Z"
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426052015Z",
          "content": {
            "details": {
              "has_action": true,
              "has_actor": true,
              "has_id": true,
              "has_resource": true,
              "has_timestamp": true
            },
            "passed": true
          },
          "description": "Audit record should have all required fields"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426058157Z",
          "content": {
            "details": {
              "outcomes": [
                "success",
                "failure",
                "denied",
                "rate_limited"
              ]
            },
            "passed": true
          },
          "description": "All audit outcomes should be defined"
        }
      ],
      "related_controls": [
        "AU-2",
        "AU-3"
      ]
    },
    {
      "control_id": "AU-14",
      "control_name": "Session Audit",
      "test_name": "session_lifecycle_logging",
      "description": "Verify session lifecycle events are logged for audit (AU-14)",
      "executed_at": "2025-12-30T21:21:02.426100273Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/session.rs",
        "line_start": 1,
        "line_end": 400,
        "function": null
      },
      "inputs": {},
      "expected": {
        "session_termination_logged": true,
        "termination_reasons_defined": true,
        "session_creation_logged": true
      },
      "observed": {
        "session_creation_logged": true,
        "session_termination_logged": true,
        "termination_reasons_defined": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426074035Z",
          "content": {
            "name": "session_policy",
            "value": {
              "idle_timeout_secs": 900,
              "max_lifetime_secs": 28800
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426078704Z",
          "content": {
            "details": {
              "has_created_at": true,
              "has_last_activity": true,
              "has_session_id": true,
              "has_user_id": true
            },
            "passed": true
          },
          "description": "Session state should have audit-relevant fields"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426086868Z",
          "content": {
            "details": {
              "count": 5,
              "reasons": [
                "UserLogout",
                "IdleTimeout",
                "MaxLifetimeExceeded",
                "AdminTermination",
                "SecurityConcern"
              ]
            },
            "passed": true
          },
          "description": "Termination reasons should be defined for audit logging"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426090184Z",
          "content": {
            "details": {
              "reason": "IdleTimeout",
              "terminated": true
            },
            "passed": true
          },
          "description": "Session termination should be auditable"
        }
      ],
      "related_controls": [
        "AC-11",
        "AC-12",
        "AU-2"
      ]
    },
    {
      "control_id": "AU-16",
      "control_name": "Cross-Organizational Audit Logging",
      "test_name": "correlation_id_handling",
      "description": "Verify correlation ID generation and extraction (AU-16)",
      "executed_at": "2025-12-30T21:21:02.426162345Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/audit/mod.rs",
        "line_start": 219,
        "line_end": 238,
        "function": null
      },
      "inputs": {},
      "expected": {
        "supports_multiple_headers": true,
        "audit_middleware_exists": true,
        "extracts_from_headers": true
      },
      "observed": {
        "audit_middleware_exists": true,
        "extracts_from_headers": true,
        "supports_multiple_headers": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426110912Z",
          "content": {
            "name": "correlation_id_source",
            "value": {
              "fallback": "timestamp-based generation",
              "function": "extract_or_generate_correlation_id",
              "headers_checked": [
                "x-correlation-id",
                "x-request-id"
              ],
              "location": "src/audit/mod.rs"
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426118025Z",
          "content": {
            "details": {
              "extracts_ids": true,
              "generates_ids": true,
              "middleware": "audit_middleware"
            },
            "passed": true
          },
          "description": "Audit middleware should handle correlation IDs"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426143942Z",
          "content": {
            "details": {
              "extracted": true,
              "header": "X-Request-ID",
              "value": "external-trace-12345"
            },
            "passed": true
          },
          "description": "Should extract correlation ID from X-Request-ID header"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426150694Z",
          "content": {
            "details": {
              "header": "X-Correlation-ID",
              "value": "corr-67890"
            },
            "passed": true
          },
          "description": "Should support X-Correlation-ID header"
        }
      ],
      "related_controls": [
        "AU-3",
        "AU-12"
      ]
    },
    {
      "control_id": "CM-6",
      "control_name": "Configuration Management",
      "test_name": "security_headers_enabled",
      "description": "Verify security headers are enabled by default (CM-6)",
      "executed_at": "2025-12-30T21:21:02.426185186Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/config.rs",
        "line_start": 35,
        "line_end": 93,
        "function": null
      },
      "inputs": {},
      "expected": {
        "tracing_enabled": true,
        "security_headers_enabled": true
      },
      "observed": {
        "tracing_enabled": true,
        "security_headers_enabled": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426172123Z",
          "content": {
            "name": "security_config",
            "value": {
              "security_headers_enabled": true,
              "tracing_enabled": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426175439Z",
          "content": {
            "details": {
              "enabled": true
            },
            "passed": true
          },
          "description": "Security headers should be enabled by default"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426177001Z",
          "content": {
            "details": {
              "enabled": true
            },
            "passed": true
          },
          "description": "Tracing should be enabled by default"
        }
      ],
      "related_controls": [
        "SC-8"
      ]
    },
    {
      "control_id": "IA-2",
      "control_name": "Identification and Authentication",
      "test_name": "mfa_policy_enforcement",
      "description": "Verify MFA policy correctly enforces multi-factor authentication (IA-2)",
      "executed_at": "2025-12-30T21:21:02.426214870Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/auth.rs",
        "line_start": 467,
        "line_end": 630,
        "function": null
      },
      "inputs": {
        "mfa_required": true
      },
      "expected": {
        "mfa_enforced_without_amr": true,
        "mfa_satisfied_with_amr": true
      },
      "observed": {
        "mfa_enforced_without_amr": true,
        "mfa_satisfied_with_amr": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426195284Z",
          "content": {
            "name": "mfa_policy",
            "value": {
              "requirement": "Multi-factor authentication required"
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426201806Z",
          "content": {
            "details": {
              "has_amr": false,
              "policy_satisfied": false
            },
            "passed": true
          },
          "description": "MFA should be enforced for claims without AMR"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426208428Z",
          "content": {
            "details": {
              "has_amr": true,
              "policy_satisfied": true
            },
            "passed": true
          },
          "description": "MFA should be satisfied with proper AMR claims"
        }
      ],
      "related_controls": [
        "IA-5"
      ]
    },
    {
      "control_id": "IA-3",
      "control_name": "Device Identification and Authentication",
      "test_name": "mtls_enforcement",
      "description": "Verify mTLS enforcement for service-to-service authentication (IA-3)",
      "executed_at": "2025-12-30T21:21:02.426276441Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/tls.rs",
        "line_start": 408,
        "line_end": 727,
        "function": null
      },
      "inputs": {
        "mtls_mode": "Required"
      },
      "expected": {
        "mtls_modes_defined": true,
        "client_cert_detection_works": true,
        "required_mode_is_fedramp_compliant": true
      },
      "observed": {
        "mtls_modes_defined": true,
        "required_mode_is_fedramp_compliant": true,
        "client_cert_detection_works": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426231881Z",
          "content": {
            "name": "mtls_modes",
            "value": {
              "default": "disabled",
              "modes": [
                "disabled",
                "optional",
                "required"
              ]
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426237671Z",
          "content": {
            "details": {
              "disabled": "disabled",
              "optional": "optional",
              "required": "required"
            },
            "passed": true
          },
          "description": "All mTLS modes should be defined"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426252558Z",
          "content": {
            "details": {
              "cert_present": true,
              "cert_verified": true,
              "subject_dn": "CN=test-service,O=TestOrg"
            },
            "passed": true
          },
          "description": "Client certificate detection should work via headers"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426257938Z",
          "content": {
            "details": {
              "cert_present": false,
              "cert_verified": false
            },
            "passed": true
          },
          "description": "Missing client certificate should be detected"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426263137Z",
          "content": {
            "details": {
              "is_fedramp_high_compliant": true,
              "mode": "required",
              "requires_cert": true
            },
            "passed": true
          },
          "description": "Required mode should be FedRAMP High compliant"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426266163Z",
          "content": {
            "details": {
              "disabled_compliant": false,
              "optional_compliant": false
            },
            "passed": true
          },
          "description": "Optional and Disabled modes should not be FedRAMP High compliant"
        }
      ],
      "related_controls": [
        "SC-8",
        "SC-23"
      ]
    },
    {
      "control_id": "IA-5",
      "control_name": "Authenticator Management",
      "test_name": "credential_security",
      "description": "Verify secure authenticator handling with constant-time comparison (IA-5)",
      "executed_at": "2025-12-30T21:21:02.426324518Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/crypto.rs",
        "line_start": 1,
        "line_end": 100,
        "function": null
      },
      "inputs": {},
      "expected": {
        "prevents_timing_attacks": true,
        "handles_unequal_lengths": true,
        "constant_time_comparison_available": true
      },
      "observed": {
        "prevents_timing_attacks": true,
        "constant_time_comparison_available": true,
        "handles_unequal_lengths": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426290416Z",
          "content": {
            "details": {
              "equal_values": true,
              "result": true
            },
            "passed": true
          },
          "description": "Constant-time comparison should match equal values"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426292771Z",
          "content": {
            "details": {
              "equal_values": false,
              "result": false
            },
            "passed": true
          },
          "description": "Constant-time comparison should reject unequal values"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426295666Z",
          "content": {
            "details": {
              "string_equal_test": true,
              "string_unequal_test": true
            },
            "passed": true
          },
          "description": "String constant-time comparison should work correctly"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426308890Z",
          "content": {
            "details": {
              "long_length": 27,
              "result": true,
              "short_length": 5
            },
            "passed": true
          },
          "description": "Should handle unequal length inputs safely"
        },
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426311975Z",
          "content": {
            "name": "crypto_implementation",
            "value": {
              "algorithm": "constant-time comparison",
              "library": "subtle crate",
              "timing_attack_resistant": true
            }
          },
          "description": null
        }
      ],
      "related_controls": [
        "IA-5(1)",
        "SC-13"
      ]
    },
    {
      "control_id": "IA-5(1)",
      "control_name": "Password-Based Authentication",
      "test_name": "password_policy_enforcement",
      "description": "Verify password policy meets NIST 800-63B requirements (IA-5(1))",
      "executed_at": "2025-12-30T21:21:02.426376582Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/password.rs",
        "line_start": 61,
        "line_end": 265,
        "function": null
      },
      "inputs": {
        "weak_password": "password123",
        "strong_password": "K9$mP2vL#nQr5xWz",
        "min_length": 12,
        "short_password": "short"
      },
      "expected": {
        "short_password_rejected": true,
        "weak_password_rejected": true,
        "strong_password_accepted": true
      },
      "observed": {
        "weak_password_rejected": true,
        "short_password_rejected": true,
        "strong_password_accepted": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.426340858Z",
          "content": {
            "name": "password_policy",
            "value": {
              "check_common_passwords": true,
              "disallow_username_in_password": true,
              "max_length": 128,
              "min_length": 12
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426348481Z",
          "content": {
            "details": {
              "result": "Err(TooShort { min: 12, actual: 11 })"
            },
            "passed": true
          },
          "description": "Weak/common password should be rejected"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426353270Z",
          "content": {
            "details": {
              "result": "Err(TooShort { min: 12, actual: 5 })"
            },
            "passed": true
          },
          "description": "Short password should be rejected"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.426366805Z",
          "content": {
            "details": {
              "result": "Ok(())"
            },
            "passed": true
          },
          "description": "Strong password should be accepted"
        }
      ],
      "related_controls": []
    },
    {
      "control_id": "IA-5(7)",
      "control_name": "No Embedded Unencrypted Static Authenticators",
      "test_name": "secret_detection_scanner",
      "description": "Verify secret detection identifies embedded authenticators (IA-5(7))",
      "executed_at": "2025-12-30T21:21:02.453382686Z",
      "duration_ms": 26,
      "code_location": {
        "file": "src/secrets.rs",
        "line_start": 1,
        "line_end": 700,
        "function": null
      },
      "inputs": {
        "test_aws_key": "AKIAIOSFODNN7EXAMPLE",
        "test_github_token": "ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
      },
      "expected": {
        "no_false_positives_on_clean_code": true,
        "detects_aws_credentials": true,
        "detects_github_tokens": true,
        "detects_private_keys": true
      },
      "observed": {
        "detects_aws_credentials": true,
        "detects_private_keys": true,
        "detects_github_tokens": true,
        "no_false_positives_on_clean_code": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.450826044Z",
          "content": {
            "name": "scanner_config",
            "value": {
              "pattern_count": 23,
              "patterns": [
                "aws-access-key-id",
                "aws-secret-key",
                "generic-api-key",
                "github-pat",
                "github-oauth",
                "github-app",
                "gitlab-pat",
                "slack-bot-token",
                "slack-webhook",
                "discord-webhook",
                "private-key",
                "jwt-token",
                "bearer-token",
                "database-url",
                "password-assignment",
                "gcp-api-key",
                "gcp-service-account",
                "azure-storage-key",
                "stripe-api-key",
                "sendgrid-api-key",
                "twilio-api-key",
                "npm-token",
                "heroku-api-key"
              ]
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.452373572Z",
          "content": {
            "details": {
              "detected": true,
              "findings_count": 1
            },
            "passed": true
          },
          "description": "Should detect AWS access keys"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.452718305Z",
          "content": {
            "details": {
              "detected": true,
              "findings_count": 1
            },
            "passed": true
          },
          "description": "Should detect GitHub tokens"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453134978Z",
          "content": {
            "details": {
              "detected": true,
              "findings_count": 1
            },
            "passed": true
          },
          "description": "Should detect private keys"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453183676Z",
          "content": {
            "details": {
              "findings_count": 0,
              "no_false_positives": true
            },
            "passed": true
          },
          "description": "Clean code should produce no findings"
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.453192272Z",
          "content": "Secret categories covered: [\"AWS Credentials\", \"API Key\", \"Git Token\", \"Private Key\", \"OAuth/JWT Token\", \"Database Credential\"]",
          "description": null
        }
      ],
      "related_controls": [
        "IA-5",
        "IA-5(1)"
      ]
    },
    {
      "control_id": "IA-6",
      "control_name": "Authentication Feedback",
      "test_name": "secure_error_responses",
      "description": "Verify authentication errors don't leak sensitive information (IA-6)",
      "executed_at": "2025-12-30T21:21:02.453437585Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/error.rs",
        "line_start": 1,
        "line_end": 300,
        "function": null
      },
      "inputs": {},
      "expected": {
        "generic_auth_errors": true,
        "no_user_enumeration": true,
        "production_hides_details": true
      },
      "observed": {
        "no_user_enumeration": true,
        "production_hides_details": true,
        "generic_auth_errors": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.453407832Z",
          "content": {
            "name": "error_config",
            "value": {
              "expose_details": false,
              "include_stack_traces": false,
              "log_errors": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453419653Z",
          "content": {
            "details": {
              "contains_user_info": false,
              "error_message": "unauthorized: Authentication failed"
            },
            "passed": true
          },
          "description": "Auth errors should not reveal if user exists"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453424291Z",
          "content": {
            "details": {
              "error_kind": "Internal",
              "has_generic_message": true
            },
            "passed": true
          },
          "description": "Internal errors should be generic in production"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453428329Z",
          "content": {
            "details": {
              "bad_password_msg": "unauthorized: Invalid credentials",
              "bad_token_msg": "unauthorized: Invalid credentials",
              "messages_equal": true
            },
            "passed": true
          },
          "description": "Different auth failures should produce same external message"
        }
      ],
      "related_controls": [
        "SI-11",
        "IA-5"
      ]
    },
    {
      "control_id": "SC-5",
      "control_name": "Denial of Service Protection",
      "test_name": "rate_limiting_configuration",
      "description": "Verify rate limiting is enabled and configured correctly (SC-5)",
      "executed_at": "2025-12-30T21:21:02.453478539Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/layers.rs",
        "line_start": 67,
        "line_end": 73,
        "function": "apply_security_layers"
      },
      "inputs": {
        "expected_rate_limit_enabled": true
      },
      "expected": {
        "has_request_timeout": true,
        "rate_limiting_enabled": true,
        "has_max_request_size": true
      },
      "observed": {
        "has_max_request_size": true,
        "has_request_timeout": true,
        "rate_limiting_enabled": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.453460346Z",
          "content": {
            "name": "security_config",
            "value": {
              "max_request_size_bytes": 1048576,
              "rate_limit_burst": 10,
              "rate_limit_enabled": true,
              "rate_limit_per_second": 5,
              "request_timeout_secs": 30
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453466638Z",
          "content": {
            "details": {
              "enabled": true
            },
            "passed": true
          },
          "description": "Rate limiting should be enabled by default"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453468261Z",
          "content": {
            "details": {
              "timeout_secs": 30
            },
            "passed": true
          },
          "description": "Request timeout should be configured"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453469824Z",
          "content": {
            "details": {
              "max_size_bytes": 1048576
            },
            "passed": true
          },
          "description": "Max request size should be configured"
        }
      ],
      "related_controls": []
    },
    {
      "control_id": "SC-8",
      "control_name": "Transmission Confidentiality and Integrity",
      "test_name": "transmission_security_configuration",
      "description": "Verify transmission security for HTTP headers and database connections (SC-8)",
      "executed_at": "2025-12-30T21:21:02.453505318Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/layers.rs",
        "line_start": 75,
        "line_end": 95,
        "function": null
      },
      "inputs": {},
      "expected": {
        "security_headers_enabled": true,
        "can_be_disabled": true
      },
      "observed": {
        "can_be_disabled": true,
        "security_headers_enabled": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.453492675Z",
          "content": {
            "name": "http_security_config",
            "value": {
              "security_headers_enabled": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453495079Z",
          "content": {
            "details": {
              "enabled": true
            },
            "passed": true
          },
          "description": "Security headers should be enabled by default"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453497454Z",
          "content": {
            "details": {
              "disabled": true
            },
            "passed": true
          },
          "description": "Security headers can be disabled when needed"
        }
      ],
      "related_controls": [
        "CM-6"
      ]
    },
    {
      "control_id": "SC-10",
      "control_name": "Network Disconnect",
      "test_name": "session_disconnect_policy",
      "description": "Verify network sessions can be disconnected per policy (SC-10)",
      "executed_at": "2025-12-30T21:21:02.453557733Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/session.rs",
        "line_start": 143,
        "line_end": 167,
        "function": null
      },
      "inputs": {},
      "expected": {
        "idle_disconnect_configured": true,
        "termination_reasons_exist": true
      },
      "observed": {
        "termination_reasons_exist": true,
        "idle_disconnect_configured": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.453526015Z",
          "content": {
            "name": "disconnect_policy",
            "value": {
              "idle_timeout_secs": 900,
              "max_lifetime_secs": 14400
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453529051Z",
          "content": {
            "details": {
              "idle_timeout_secs": 900
            },
            "passed": true
          },
          "description": "Idle timeout should be configured for disconnection"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453544819Z",
          "content": {
            "details": {
              "reasons": [
                {
                  "message": "Your session timed out due to inactivity. Please sign in again.",
                  "variant": "IdleTimeout"
                },
                {
                  "message": "Your session has expired. Please sign in again.",
                  "variant": "MaxLifetimeExceeded"
                },
                {
                  "message": "Your session can no longer be extended. Please sign in again.",
                  "variant": "MaxExtensionsExceeded"
                },
                {
                  "message": "Your session has expired. Please sign in again.",
                  "variant": "TokenExpired"
                },
                {
                  "message": "You have been signed out.",
                  "variant": "UserLogout"
                }
              ]
            },
            "passed": true
          },
          "description": "Termination reasons should have descriptive messages"
        }
      ],
      "related_controls": [
        "AC-11",
        "AC-12"
      ]
    },
    {
      "control_id": "SC-12",
      "control_name": "Cryptographic Key Establishment and Management",
      "test_name": "key_rotation_policy",
      "description": "Verify key rotation policies and lifecycle management (SC-12)",
      "executed_at": "2025-12-30T21:21:02.453626497Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/keys.rs",
        "line_start": 321,
        "line_end": 447,
        "function": null
      },
      "inputs": {
        "rotation_interval_days": 90
      },
      "expected": {
        "rotation_policy_works": true,
        "key_lifecycle_tracked": true,
        "key_states_defined": true
      },
      "observed": {
        "key_lifecycle_tracked": true,
        "key_states_defined": true,
        "rotation_policy_works": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.453574633Z",
          "content": {
            "name": "rotation_policy",
            "value": {
              "interval_days": 90,
              "warn_before_days": 7
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453585613Z",
          "content": {
            "details": {
              "needs_rotation": false
            },
            "passed": true
          },
          "description": "Freshly registered key should not need rotation"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453587967Z",
          "content": {
            "details": {
              "can_decrypt": true,
              "can_encrypt": true
            },
            "passed": true
          },
          "description": "Active key should support encrypt and decrypt"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453610268Z",
          "content": {
            "details": {
              "states": [
                {
                  "can_decrypt": true,
                  "can_encrypt": true,
                  "state": "Active"
                },
                {
                  "can_decrypt": true,
                  "can_encrypt": false,
                  "state": "DecryptOnly"
                },
                {
                  "can_decrypt": false,
                  "can_encrypt": false,
                  "state": "Disabled"
                },
                {
                  "can_decrypt": false,
                  "can_encrypt": false,
                  "state": "PendingDestruction"
                },
                {
                  "can_decrypt": false,
                  "can_encrypt": false,
                  "state": "Destroyed"
                }
              ]
            },
            "passed": true
          },
          "description": "Key states should have correct capabilities"
        }
      ],
      "related_controls": [
        "SC-13"
      ]
    },
    {
      "control_id": "SC-13",
      "control_name": "Cryptographic Protection",
      "test_name": "constant_time_comparison",
      "description": "Verify constant-time comparison prevents timing attacks (SC-13)",
      "executed_at": "2025-12-30T21:21:02.453653926Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/crypto.rs",
        "line_start": 37,
        "line_end": 50,
        "function": null
      },
      "inputs": {},
      "expected": {
        "equal_values_match": true,
        "different_values_differ": true,
        "different_lengths_differ": true
      },
      "observed": {
        "different_lengths_differ": true,
        "equal_values_match": true,
        "different_values_differ": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453643598Z",
          "content": {
            "details": {
              "result": true
            },
            "passed": true
          },
          "description": "Equal values should match"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453645561Z",
          "content": {
            "details": {
              "result": false
            },
            "passed": true
          },
          "description": "Different values should not match"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453646894Z",
          "content": {
            "details": {
              "result": false
            },
            "passed": true
          },
          "description": "Different length values should not match"
        }
      ],
      "related_controls": []
    },
    {
      "control_id": "SC-13-FIPS",
      "control_name": "FIPS 140-3 Cryptographic Protection",
      "test_name": "fips_validated_crypto",
      "description": "Verify FIPS 140-3 validated cryptography is available (SC-13)",
      "executed_at": "2025-12-30T21:21:02.453820417Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/encryption.rs",
        "line_start": 150,
        "line_end": 250,
        "function": null
      },
      "inputs": {
        "fips_feature": false
      },
      "expected": {
        "fips_mode_detectable": true,
        "encryption_works": true
      },
      "observed": {
        "encryption_works": true,
        "fips_enabled": false,
        "fips_mode_detectable": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.453670476Z",
          "content": {
            "name": "fips_config",
            "value": {
              "fips_certificate": null,
              "fips_mode_enabled": false
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453673702Z",
          "content": {
            "details": {
              "detection_available": true,
              "fips_enabled": false
            },
            "passed": true
          },
          "description": "FIPS mode should be detectable"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453811221Z",
          "content": {
            "details": {
              "algorithm": "AES-256-GCM (RustCrypto)",
              "roundtrip_success": true
            },
            "passed": true
          },
          "description": "Encryption should work correctly"
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.453813926Z",
          "content": "FIPS mode not enabled (using RustCrypto)",
          "description": null
        }
      ],
      "related_controls": [
        "SC-12",
        "SC-28"
      ]
    },
    {
      "control_id": "SC-23",
      "control_name": "Session Authenticity",
      "test_name": "session_state_protection",
      "description": "Verify session state authenticity and anti-tampering (SC-23)",
      "executed_at": "2025-12-30T21:21:02.464742303Z",
      "duration_ms": 10,
      "code_location": {
        "file": "src/session.rs",
        "line_start": 1,
        "line_end": 400,
        "function": null
      },
      "inputs": {},
      "expected": {
        "session_has_unique_id": true,
        "session_can_be_invalidated": true,
        "session_tracks_creation": true,
        "session_tracks_activity": true
      },
      "observed": {
        "session_can_be_invalidated": true,
        "session_tracks_activity": true,
        "session_tracks_creation": true,
        "session_has_unique_id": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453840834Z",
          "content": {
            "details": {
              "session1_id": "session-aaa-111",
              "session2_id": "session-bbb-222",
              "unique": true
            },
            "passed": true
          },
          "description": "Sessions should have unique identifiers"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.453844631Z",
          "content": {
            "details": {
              "has_created_at": true,
              "timestamp_type": "std::time::Instant"
            },
            "passed": true
          },
          "description": "Session should track creation time"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.464597611Z",
          "content": {
            "details": {
              "activity_updated": true,
              "after": "Some(Instant { tv_sec: 1663666, tv_nsec: 212957332 })",
              "before": "Some(Instant { tv_sec: 1663666, tv_nsec: 202345277 })"
            },
            "passed": true
          },
          "description": "Session should track last activity for idle timeout"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.464637854Z",
          "content": {
            "details": {
              "now_terminated": true,
              "termination_reason": "SecurityConcern",
              "was_active": true
            },
            "passed": true
          },
          "description": "Session should be invalidatable for security"
        },
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.464650848Z",
          "content": {
            "name": "session_policy",
            "value": {
              "enforces_timeouts": true,
              "idle_timeout_secs": 900,
              "max_lifetime_secs": 28800
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.464670573Z",
          "content": {
            "details": {
              "idle_timeout": 900,
              "max_lifetime": 28800,
              "policy_configured": true
            },
            "passed": true
          },
          "description": "Session policy should enforce timeout checks"
        }
      ],
      "related_controls": [
        "AC-11",
        "AC-12",
        "SC-10"
      ]
    },
    {
      "control_id": "SC-28",
      "control_name": "Protection of Information at Rest",
      "test_name": "field_level_encryption",
      "description": "Verify field-level encryption protects data at rest (SC-28)",
      "executed_at": "2025-12-30T21:21:02.465267492Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/encryption.rs",
        "line_start": 1,
        "line_end": 700,
        "function": null
      },
      "inputs": {
        "key_size_bits": 256,
        "algorithm": "AES-256-GCM"
      },
      "expected": {
        "encryption_roundtrip_works": true,
        "tamper_detection_works": true,
        "unique_nonces_per_encryption": true,
        "encryption_available": true
      },
      "observed": {
        "unique_nonces_per_encryption": true,
        "encryption_available": true,
        "tamper_detection_works": true,
        "encryption_roundtrip_works": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.464836894Z",
          "content": {
            "name": "encryption_config",
            "value": {
              "algorithm": "Aes256Gcm",
              "require_encryption": true,
              "verify_database_encryption": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.464851741Z",
          "content": {
            "details": {
              "key_size": 32,
              "nonce_size": 12,
              "tag_size": 16
            },
            "passed": true
          },
          "description": "AES-256-GCM algorithm properties are correct"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.464901761Z",
          "content": {
            "details": {
              "algorithm": "AES-256-GCM",
              "key_length": 64
            },
            "passed": true
          },
          "description": "Field encryptor can be initialized with valid key"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465103446Z",
          "content": {
            "details": {
              "decrypted_matches": true,
              "encrypted_len": 72,
              "plaintext_len": 25
            },
            "passed": true
          },
          "description": "Encryption roundtrip preserves data"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465184112Z",
          "content": {
            "details": {
              "field_roundtrip": true
            },
            "passed": true
          },
          "description": "EncryptedField wrapper works correctly"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465217051Z",
          "content": {
            "details": {
              "tamper_detected": true
            },
            "passed": true
          },
          "description": "Tampered ciphertext is detected and rejected"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465242327Z",
          "content": {
            "details": {
              "unique_nonces": true
            },
            "passed": true
          },
          "description": "Each encryption uses unique nonce (no ciphertext reuse)"
        },
        {
          "evidence_type": "log",
          "timestamp": "2025-12-30T21:21:02.465254890Z",
          "content": "Encryption verification: field_encryption=true, compliant=true",
          "description": null
        }
      ],
      "related_controls": [
        "SC-13",
        "SC-12"
      ]
    },
    {
      "control_id": "SI-10",
      "control_name": "Information Input Validation",
      "test_name": "email_validation_and_xss_sanitization",
      "description": "Verify input validation rejects malformed data and sanitizes XSS (SI-10)",
      "executed_at": "2025-12-30T21:21:02.465346235Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/validation.rs",
        "line_start": 237,
        "line_end": 380,
        "function": null
      },
      "inputs": {
        "invalid_email": "not-an-email",
        "valid_email": "user@example.com",
        "xss_payload": "<script>alert('xss')</script>"
      },
      "expected": {
        "xss_sanitized": true,
        "valid_email_accepted": true,
        "invalid_email_rejected": true
      },
      "observed": {
        "invalid_email_rejected": true,
        "valid_email_accepted": true,
        "xss_sanitized": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465304780Z",
          "content": {
            "details": {
              "result": "Ok(())"
            },
            "passed": true
          },
          "description": "Valid email should be accepted"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465317663Z",
          "content": {
            "details": {
              "result": "Err(ValidationError { field: Some(\"email\"), code: InvalidEmail, message: \"Invalid email format\" })"
            },
            "passed": true
          },
          "description": "Invalid email should be rejected"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465329885Z",
          "content": {
            "details": {
              "input": "<script>alert('xss')</script>",
              "output": "alert('xss')",
              "script_removed": true
            },
            "passed": true
          },
          "description": "XSS payload should be sanitized"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465335896Z",
          "content": {
            "details": {
              "result": "Ok(())"
            },
            "passed": true
          },
          "description": "Length validation should work"
        }
      ],
      "related_controls": []
    },
    {
      "control_id": "SI-11",
      "control_name": "Error Handling",
      "test_name": "secure_error_responses",
      "description": "Verify errors do not leak sensitive info in production (SI-11)",
      "executed_at": "2025-12-30T21:21:02.465398199Z",
      "duration_ms": 0,
      "code_location": {
        "file": "src/error.rs",
        "line_start": 50,
        "line_end": 150,
        "function": null
      },
      "inputs": {},
      "expected": {
        "prod_hides_details": true,
        "dev_shows_details": true
      },
      "observed": {
        "prod_hides_details": true,
        "dev_shows_details": true
      },
      "passed": true,
      "failure_reason": null,
      "evidence": [
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.465370348Z",
          "content": {
            "name": "production_config",
            "value": {
              "expose_details": false,
              "include_stack_traces": false,
              "log_errors": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465376590Z",
          "content": {
            "details": {
              "expose_details": false
            },
            "passed": true
          },
          "description": "Production config should hide error details"
        },
        {
          "evidence_type": "configuration",
          "timestamp": "2025-12-30T21:21:02.465380146Z",
          "content": {
            "name": "development_config",
            "value": {
              "expose_details": true,
              "include_stack_traces": true
            }
          },
          "description": null
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465384063Z",
          "content": {
            "details": {
              "expose_details": true
            },
            "passed": true
          },
          "description": "Development config should show error details"
        },
        {
          "evidence_type": "assertion",
          "timestamp": "2025-12-30T21:21:02.465389042Z",
          "content": {
            "details": {
              "expose_details": false,
              "kind": "Internal"
            },
            "passed": true
          },
          "description": "Internal errors should not expose details"
        }
      ],
      "related_controls": []
    }
  ],
  "summary": {
    "total_controls": 29,
    "passed": 29,
    "failed": 0,
    "skipped": 0,
    "total_duration_ms": 36,
    "pass_rate": 100.0,
    "by_family": {
      "SI": {
        "total": 2,
        "passed": 2,
        "failed": 0
      },
      "AU": {
        "total": 7,
        "passed": 7,
        "failed": 0
      },
      "CM": {
        "total": 1,
        "passed": 1,
        "failed": 0
      },
      "AC": {
        "total": 5,
        "passed": 5,
        "failed": 0
      },
      "IA": {
        "total": 6,
        "passed": 6,
        "failed": 0
      },
      "SC": {
        "total": 8,
        "passed": 8,
        "failed": 0
      }
    }
  }
}